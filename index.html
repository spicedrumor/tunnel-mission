<HTML>
<HEAD>
<TITLE> Tunnel Mission </TITLE>
</HEAD>
<BODY>

<script language="Javascript">
  var KEY_CODE_W = 87;
  var KEY_CODE_A = 65;
  var KEY_CODE_S = 83;
  var KEY_CODE_D = 68;
  var map;
  var mapString;
  var xPos;
  var yPos;

  xPos = 0;
  yPos = 0;

  map = [
    [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
  ];

  function validMove(newX, newY)
  {
    var result;
    var mapWidth;
	var mapHeight;
	var notTooSmall;
	var notTooBig;

    result = false;
	mapWidth = map[0].length;
	mapHeight = map.length;

	if (newX >= 0 && newY >= 0)
	{
      notTooSmall = true;
	}
	if (newX < mapWidth && newY < mapHeight)
	{
	  notTooBig = true;
	}

	if (notTooSmall && notTooBig)
	{
      result = true;
	}

	return result;
  }

  function move(direction)
  {
    var offsetX;
	var offsetY;

	offsetX = 0;
	offsetY = 0;

	if (direction === "n")
	{
	  offsetY = -1;
	}
	else if (direction === "e")
	{
	  offsetX = 1;
	}
	else if (direction === "s")
	{
	  offsetY = 1;
	}
	else if (direction === "w")
	{
	  offsetX = -1;
	}

	if (validMove(xPos + offsetX, yPos + offsetY))
	{
	  map[yPos][xPos] = 0;
	  xPos += offsetX;
	  yPos += offsetY;
	  map[yPos][xPos] = 1;
	}
	else
	{
	}
  }

window.onkeyup = function(e)
{
  var key = e.keyCode ? e.keyCode : e.which;
        
  if (key == KEY_CODE_W)
  {
    move("n");
  }
  if (key == KEY_CODE_D)
  {
    move("e");
  }
  else if (key == KEY_CODE_S)
  {
    move("s");
  }
  if (key == KEY_CODE_A)
  {
    move("w");
  }
        
  mapString = mapToString(map);
  document.body.innerHTML = mapString;
}

  function mapToString(map)
  {
    var i;
	var j;
	var result;

    result = "<h2><code>";
	for (i = 0; i < map.length; i++)
	{
      for (j = 0; j < map[0].length; j++)
	  {
        if (map[i][j] == 1)
		{
		  result += "@";
		}
		else if (map[i][j] == 0)
		{
		  result += ".";
		}
		else
		{
		  result += map[i][j];
		}
	  }
      result += "<br>";
	}

	result += "</code></h2><br>";
    return result;
  }

  mapString = mapToString(map);
  document.body.innerHTML += mapString;
</script>

</BODY>
</HTML>
